package main

import (
    "context"
    "log/slog"
    "os"
    "{{.PkgPath}}"
)

func main() {
    // Настраиваем slog handler
    handler := slog.NewJSONHandler(os.Stdout, &slog.HandlerOptions{
        Level: slog.LevelDebug,
    })
    logger := slog.New(handler)
    slog.SetDefault(logger)
    
    // Инициализируем клиент с логированием
    client := {{.PkgName}}.New("http://localhost:9000",
        {{.PkgName}}.LogRequest(),
    )
    
    // Создаем контекст с дополнительными полями для логирования
    // Используем slog.With() для создания контекста с полями
    // Эти поля будут автоматически включены во все логи, созданные с этим контекстом
    ctx := context.Background()
    ctx = slog.With("request_id", "req-12345", "user_id", "user-67890").WithContext(ctx)
    
    // Использование клиента
    // Контекст с дополнительными полями будет автоматически использован в логах
    {{.ServiceVar}} := client.{{.ContractName}}()
    {{.ResultVar}}, err := {{.MethodCall}}
    if err != nil {
        slog.ErrorContext(ctx, "Request failed",
            slog.String("service", "{{.ContractName}}"),
            slog.String("method", "{{.MethodName}}"),
            slog.Any("error", err),
        )
        return
    }
    slog.InfoContext(ctx, "Request completed successfully",
        slog.String("service", "{{.ContractName}}"),
        slog.String("method", "{{.MethodName}}"),
        slog.Group("response",
            slog.Any("result", {{.ResultVar}}),
        ),
    )
}

