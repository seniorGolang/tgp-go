//go:build wasip1

// GENERATED BY 'T'ool 'G'ateway. DO NOT EDIT.
package net

import (
	"time"

	"tgp/core/wasm"
)

// SetDeadline устанавливает дедлайн для чтения и записи.
func (c *Conn) SetDeadline(t time.Time) (err error) {

	c.readDeadline = t
	c.writeDeadline = t

	// Передаем deadline на host сторону
	var deadline uint64
	if !t.IsZero() {
		nanos := t.UnixNano()
		if nanos < 0 {
			deadline = 0
		} else {
			deadline = uint64(nanos)
		}
	}

	return wasm.CallHostUint64WithDeadline(conn_set_deadline, c.id, deadline)
}

// SetReadDeadline устанавливает дедлайн для чтения.
func (c *Conn) SetReadDeadline(t time.Time) (err error) {

	c.readDeadline = t

	// Передаем deadline на host сторону
	var deadline uint64
	if !t.IsZero() {
		nanos := t.UnixNano()
		if nanos < 0 {
			deadline = 0
		} else {
			deadline = uint64(nanos)
		}
	}

	return wasm.CallHostUint64WithDeadline(conn_set_read_deadline, c.id, deadline)
}

// SetWriteDeadline устанавливает дедлайн для записи.
func (c *Conn) SetWriteDeadline(t time.Time) (err error) {

	c.writeDeadline = t

	// Передаем deadline на host сторону
	var deadline uint64
	if !t.IsZero() {
		nanos := t.UnixNano()
		if nanos < 0 {
			deadline = 0
		} else {
			deadline = uint64(nanos)
		}
	}

	return wasm.CallHostUint64WithDeadline(conn_set_write_deadline, c.id, deadline)
}
