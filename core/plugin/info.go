// GENERATED BY 'T'ool 'G'ateway. DO NOT EDIT.
package plugin

// PluginInfo содержит информацию о плагине.
// Все поля сериализуемы в JSON для совместимости с WASM.
type Info struct {
	// Name - уникальное имя плагина.
	Name string `json:"name"`
	// Description - краткое описание плагина.
	Description string `json:"description"`
	// Author - автор плагина.
	Author string `json:"author"`
	// License - лицензия плагина.
	License string `json:"license"`
	// Category - категория плагина (объявляется плагином, например: "server", "client", "documentation").
	Category string `json:"category"`
	// Commands - список команд, которые предоставляет плагин.
	// Каждая команда может иметь свой путь, описание и опции.
	Commands []Command `json:"commands"`
	// Group - группа плагинов для совместимости (плагины из одной группы совместимы друг с другом).
	// Используется для группировки связанных плагинов (зарезервировано для будущего использования).
	Group string `json:"group,omitempty"`
	// Doc - документация плагина в формате Markdown.
	Doc string `json:"doc"`
	// Options - описание настроек, которые плагин принимает (общие для всех команд, если не переопределены в Command).
	Options []Option `json:"options"`
	// AllowedHosts - белый список хостов для сетевых подключений (только для WASM плагинов).
	// Если пусто, плагин не может выполнять сетевые подключения.
	// Поддерживаемые форматы:
	// - Доменные имена: точное совпадение ("api.example.com") или wildcard ("*.example.com")
	// - IP-адреса: точное совпадение ("192.168.1.1", "::1", "[2001:db8::1]") или CIDR ("192.168.1.0/24", "2001:db8::/32")
	// - Проверка резолва: если домен резолвится в разрешённый IP (точное совпадение или CIDR), подключение разрешается
	// Пример: ["api.example.com", "*.example.com", "192.168.1.0/24", "10.0.0.1"]
	AllowedHosts []string `json:"allowedHosts,omitempty"`
	// AllowedShellCMDs - белый список команд, которые плагин может запускать через хост (только для WASM плагинов).
	// Если пусто, плагин не может выполнять команды.
	// Формат: имена команд (например: ["go", "git", "npm"])
	AllowedShellCMDs []string `json:"allowedShellCMDs,omitempty"`
	// AllowedEnvVars - белый список переменных окружения, которые плагин может получать от хоста (только для WASM плагинов).
	// Если пусто, плагин не получает переменные окружения от хоста.
	// Формат: имена переменных окружения (например: ["PATH", "HOME", "USER", "GOROOT", "GOPATH"])
	AllowedEnvVars []string `json:"allowedEnvVars,omitempty"`
	// Dependencies - список зависимостей плагина.
	// Формат: ["plugin-name1", "plugin-name2@^1.0.0", "source:plugin-name3@^2.1.0", "source:plugin-name4"]
	// Поддерживаемые форматы:
	// - package - зависимость из того же репозитория без указания версии
	// - package@version - зависимость из того же репозитория с версией
	// - source:package - зависимость из другого репозитория без указания версии (source - URL репозитория)
	// - source:package@version - зависимость из другого репозитория с версией (source - URL репозитория)
	// Версия указывается с учетом semver совместимости (^, ~, >= и т.д.).
	// Определяет порядок выполнения: зависимости выполняются перед плагином.
	// Для pre и stage плагинов определяет цепочку выполнения до команды.
	// Команды не могут быть зависимостями других плагинов.
	// Если версия не указана, то совместимость с любыми версиями.
	// Если зависимость не установлена, tg предлагает её установить.
	Dependencies []string `json:"dependencies,omitempty"`
	// Kind - тип плагина: "pre", "stage", "command", "post".
	// Определяет роль плагина в цепочке выполнения.
	// - "pre" - плагины, выполняющиеся первыми до команды (подготовка данных)
	// - "stage" - промежуточные плагины, выполняющиеся после pre, но до command (обработка данных)
	// - "command" - основная команда, выполняемая пользователем
	// - "post" - плагины, выполняющиеся после команды (финализация)
	// Порядок выполнения: pre -> stage -> command -> post
	// Если не указано, определяется автоматически: если есть Commands, то "command", иначе "stage".
	Kind string `json:"kind,omitempty"`
	// Always - для pre и post плагинов: выполнять ли всегда для всех команд.
	// По умолчанию false (плагин выполняется только при наличии зависимостей в цепочке).
	// Если true, плагин выполняется для всех команд независимо от зависимостей.
	// Плагины с always=true не входят в прямую цепочку зависимостей, но выполняются всегда.
	// Может использоваться только с kind="pre" или kind="post".
	Always bool `json:"always,omitempty"`
	// Silent - для pre, post и stage плагинов: не выводить ли логи при выполнении.
	// По умолчанию false (хост может выводить логи при выполнении).
	// Если true, хост не выводит логи при выполнении, но плагин может выводить логи сам, если посчитает нужным.
	Silent bool `json:"silent,omitempty"`
	// AllowedStdOut - разрешить ли плагину доступ к stdout хоста (только для WASM плагинов).
	// По умолчанию false. Если true, при инстанцировании модуля плагину передаётся stdout для вывода.
	AllowedStdOut bool `json:"allowed_std_out,omitempty"`
	// AllowedStdErr - разрешить ли плагину доступ к stderr хоста (только для WASM плагинов).
	// По умолчанию false. Если true, при инстанцировании модуля плагину передаётся stderr для вывода ошибок.
	AllowedStdErr bool `json:"allowed_std_err,omitempty"`
	// InitPkgs - список пакетов (директорий), которые плагин имеет право создать при plugin init.
	// Указываются имена пакетов, которые будут созданы в корне проекта (например: ["astg", "mypackage"]).
	// Плагину будет предоставлен доступ на запись к папке @root/<имя_пакета> в корне проекта.
	// Если несколько плагинов объявляют один и тот же пакет, выполняется только один плагин,
	// остальные получают предупреждение о конфликте и пропускаются.
	InitPkgs []string `json:"initPkgs,omitempty"`
	// AllowedPaths - белый список путей файловой системы с указанием уровня доступа.
	// Применяется при обычном выполнении плагина (Execute).
	// Если пусто, плагин НЕ имеет доступа к файловой системе (доступ запрещён).
	// Ключ - путь к каталогу или файлу (поддерживаются абсолютные пути, переменные окружения через $VAR или ${VAR}, и ~ для домашней папки).
	// Также поддерживаются специальные префиксы: @root (корень проекта), @go (GOPATH).
	// Значение - уровень доступа: "r" (только чтение), "w" (чтение и запись, полный доступ).
	// Пример: {"internal/cli": "w", "$HOME/.config": "r", "~/data": "w", "/tmp/cache": "w", "@root/pkg": "r"}
	AllowedPaths map[string]string `json:"allowedPaths,omitempty"`
}

// Command описывает команду плагина.
type Command struct {
	Path            []string `json:"path"`
	Description     string   `json:"description"`
	LongDescription string   `json:"longDescription,omitempty"` // Подробное описание команды (для help). Если не указано, используется info.Doc
	// Options - описание настроек, которые плагин принимает.
	Options []Option `json:"options"`
}

// Option описывает одну настройку плагина.
// Все поля сериализуемы в JSON для совместимости с WASM.
type Option struct {
	// Name - полное имя настройки (ключ, используется как --name в CLI).
	Name string `json:"name"`
	// Short - краткое имя настройки (используется как -s в CLI, опционально).
	Short string `json:"short,omitempty"`
	// Type - тип значения настройки (string, int, bool и т.д.).
	Type string `json:"type"`
	// Description - описание настройки.
	Description string `json:"description"`
	// Required - обязательна ли настройка.
	Required bool `json:"required"`
	// Default - значение по умолчанию (может быть nil).
	// Должно быть JSON-сериализуемым для совместимости с WASM.
	Default any `json:"default,omitempty"`
	// IsPositional - true для позиционных аргументов (не флагов).
	// Позиционные аргументы передаются без флагов, например: `tg plugin install <package>`.
	IsPositional bool `json:"isPositional,omitempty"`
}
